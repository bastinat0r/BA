\section{Hardware}

\subsection{Ranging Hardware}

There are several different possible hardware plattforms for the Atmel ranging software.
At the time this thesis started however we only had a precompiled libary for the Atmel ranging modules \todo{exact name}.
For the evaluation scenario those modules are quite useable, but there are better options available with the binaries for other hardware plattforms.
On the copters we want to use \$Module from dresden elektronik which is already integrated into the new hardware revision of the FINken robots.

The disadvantage of the Atmel sensors is that they are not designed for production use but as development plattforms and therefore are quite big and heavy and not really suited to be used on the FINken quadcopters.
It is possible however to build a simmilar hardware setup that is much smaller by using smaller packages of the same chips, leaving lots of unused PCB area and unused connectors.

\subsection{Autopilot}
The FINken robots use the LISA/MX autopilot board in hardware revision 2.1.
This board is used for higher level auto pilot functions as well as pure stabilizationâ€“unlike other UAV projects where there are different units for stabilization control and higher levelfunctions like pathfinding.
This means that all sensors are connected to this board; every computation from evaluation of sensor input to the output of PWM signals to the motors controllers is done on this board.

\section{Interconnect}
There are diffrent solutions to connecting the ranging board to the Paparazzi autopilot.
All of the following methods of connecting hardware are supported by the LISA/MX board and one has to be chosen for the new ranging sensors.


\subsection{Pulse width modulation / Analog value}
Using a single GPIO pin or analog value is completely impractical, but a good example to explain the problems the honest solutions need to address.

First of all there is a limited number of GPIO or ADC-pins on both boards.
On the autopilot board those pins are quite rare, especially because they cannot be shared easily between components.
The second problem is that we do not only need to read a range value from the sensor but we also need to tell the sensor which value to fetch.
Therefore some kind of bidirectional communication between autopilot and sensor need to take place.
The big advantage of using a GPIO pin would be that only one single wire\footnote{Plus two wires for voltage supply} would be needed to connect autopilot and sensor.

\subsection{UART}
The "Universal Asynchronous Receiver/Transmitter"-Protocol uses two wires to establish communication between devices.
\cite{wingen_automatic_2004}

The Disadvantage of UART-style Protocols is that it is a bidirectional connection.
That two pins are needed on sender and reciever side and if another device should be connected two new pins are needed.
On the Lisa/MX autopilot there are four dedicated UART connections that might be used, but already three of them are used.

\subsection{SPI}
6 Pins, Clocked, Chainable, DMA

\subsection{CAN bus}
Would be ok, no can device yet, pins for canbus already in use, would be solvable, but not easy to implement on ranging nodes

\subsection{I2C}
I2C is a two wired bus protocol that can be used to connect multiple slave devices to one master device.
There already are multiple sensors connected to the autopilot via I2C.
All of the ultrasound-sensors and also the optionalcolorsensor use I2C to communicate with the autopilot.
The autopilot board also supports to have two independent i2c-networks.

Especially the fact that there already is a sensor network on the FINken makes it the best choice as a communication protocol for the new sensor.

\todo{problem: slaves can block the bus}

