
\section{Robustness of Implementation}

For use in the FINken robots not only the quality of the measurements is relevant.
The sensor also needs to be well integrated into the autopilot framework.

With the current hardware this integration can not be done completly, because the current hardware plattform is simply to big to fly.
This step of integration will be done with the \todo{de-modules}.

\subsection{Bus hangup}
I2C is an easy to implement and use bus protocol.
One of the drawbacks of I2C is that misbehaving clients are able to block the whole bus.
As a consequence a malfunctioning sensor might render the others sensors useless, in worst case crashing the copter.

At the moment the ranging sensors cause bus hangups, when rangings are requested to often.
\todo{measure}

\subsection{i2c errors per time}
Another problem that may occure is that i2c data packets can get lost.
This would mean the autopilot has to rely on expired data and it might break any kind of derivate computed from the range value \todo{jaja, als ob man da was sinvolles ausrechnen könnte :(}.
\todo{measure}

\subsection{Integration Test for Quadcopter}


\section{Ranging Accuracy}

\subsection{Frequency Selection}
The frequencys used by the ranging can be chosen.
Especially because normal \SI{2.4}{\giga\hertz} wifi and serveral other technologies are using the same frequencys as the ranging modules the selection of a well working one is crucial to ranging performance.
In \autoref{spectrum2437} there is an analysis on the frequency utilization on wifi channel 6.
A download was started and then ended which is noticable in the waterfall plot.

Comparing the utilization on this channel with the frequency range shown in \autoref{spectrum2483} which is right next to the first frequency used by the ranging modules several things can be noticed.
The noise in the frequency range for ranging is much lower then on frequencys with used for wifi—about \SI{15}{dB} in average and \SI{20}{dB} in peak.
You can also see the peak generated by the ranging modules.
The line at the center frequency \SI{2.4831}{\giga\hertz} is an artifact created by the SDR that was used, but the line at \SI{2.483}{\giga\hertz} is created by the ranging modules (which is exactly why the center frequency was chosen right next to the actual frequency).
You can already see that the peak can still be lost in noise like it is shown in the FFT plot but is very stable over time as you can see in the waterfall plot.

Because of the lower utilization of those frequencys a range of \SI{2.480}{\giga\hertz} to \SI{2.500}{\giga\hertz} has been chosen.
All the frequencys in this range look quite simmilar to the sample taken at \autoref{spectrum2483}.

\begin{figure}[H]
	\centering
\includegraphics[width=0.9\textwidth]{figures/ch6.png}
\label{spectrum2437}
\caption{RF-Spectrum on \SI{2.437}{\giga\hertz}}
\end{figure}

\begin{figure}[H]
	\centering
\includegraphics[width=0.9\textwidth]{figures/ranging_0.png}
\label{spectrum2483}
\caption{RF-Spectrum on \SI{2.483}{\giga\hertz}}
\end{figure}


\subsection{Influence of DQF on Range Values}
One value the ranging api provides is the DQF\footnote{Data Quality Factor}-value.
It is reasonable to expect a huge amount of scatter for lower DQF values.
As \autoref{1m_scatterplot} shows this is not how the range value behaves.

For the values measured with \SI{1}{\metre} real distance we can see that the values measered with lower quality do not have the same mean value as those with higher quality.
Also values measured with lower quality are closer to each other than those with higher signal quality.
As long as we only look at the values taken at \SI{1}{\metre} real distance it seams like we could be able to improve the range estimate by including the dqf value into the computation of the distance.
To do that this behaviour would need to be stable accross different distances, i.e. no matter if the measurement is taken at \SI{1}{\metre} or \SI{3}{\metre} distance the when the dqf is low the measured range is lower and if dqf is high the measured range is higher.
\begin{figure}[H]
	\centering
	\input{figures/scatterplot_1000_1m.pgf}
	\caption{1000 values measured at \SI{1}{\metre} distance}
	\label{1m_scatterplot}
\end{figure}

\autoref{range_05_to_2m} shows measurements taken at different distances.
The values for further distances have far more noise than values for lower distances.
This leads to bad consequences.
\begin{figure}[H]
	\centering
	\input{figures/range_05_to_2m.pgf}
	\caption{values measured at \SI{0.5}{\metre} to \SI{2}{\metre} real distance}
	\label{range_05_to_2m}
\end{figure}

\begin{figure}[H]
	\centering
	\input{figures/2m.pgf}
	\caption{100 values measured at \SI{2}{\metre} distance}
	\label{2m}
\end{figure}

\subsection{Influence of Distance}

It is important to know how the ranging nodes behave at different distances.
In \autoref{boxplot} this relationship is shown.
The results are not what was hoped for when the hardware was selected.
As you can see in \autoref{boxplot} the lower values yielded for any given distance might be in the intervall yielded for pretty much all distances.
Additionaly the mean values are not even nearly monotone, there are some irregularities in the values where a higher distance leads to lower range values.
\todo{prettify}
\begin{landscape}
	\begin{figure}[H]
		\centering
		\input{figures/boxplot.pgf}
		\caption{range values and real distance}
		\label{boxplot}
	\end{figure}
\end{landscape}

\subsection{Antenna Orientation}
\todo{ (diversity, no diversity) * (parallel, perpendicular) }



\subsection{Orientation of Devices}


\subsection{Moving Nodes}

\subsection{Ranging on FINken Robots}

\section{Properties of a Distance Function}
The ranging sensor on the FINken robot shall be used to provide a distance between two quadcopters, similar to a distance measure used in swarm intelligence algorithms.
In the pure mathematical sense a distance function has to fullfill certian properties.

If $f(x, y)$ is a distance function it has to have the following properties.
\begin{eqnarray}
f(x, y) \ge 0 \\
f(x, y) = 0 \iff x = y \\ 
f(x, y) = f(y, x) \\ 
f(x, z) \le f(x, y) + f(y, z)
\end{eqnarray}

Of course the value measured by any real sensor will not completly accomplish to satisfy those conditions.
For use in swarm robotics it is therefore very interesting to know in which way the range values break the pattern of a mathematical distance function.

\subsection{Non-negativity and Coincidence}

The first property of a mathematical distance measure to look at is non-negativity. This is quite easy: The values yielded by the ranging modules are clearly positiv.
Also the property of coincidence is always given.
Each module has a unique address and is therefore able to check, if it is ranging itself.
Having two modules occupy the same physical spot is obviosly not possible so there cannot be two different modules that are equvivalent in a mathematical sense.

\subsection{Symmetry}

In this section the following notation will be used: $A \rightarrow B$ means a range reading is taken from node A with B as reflector node.

Symmetry is a property that can not be achieved by the ranging sensors because of noise. 
A range reading $A \rightarrow B$ will not be equal to the reading for $B \rightarrow A$ just because the two readings will be altered by noise.
The question that remains is: Do we have the same error for both directions.

\todo{measure, plot, evaluate}


\subsection{Triangle Inequality}
The Triangle Inequality will also be broken by noise.
I.e. if we measure $d(A,B) + X + d(B,C) + X$ and $d(A, C) + X$ the measurement error $X$ might as well break the condition of the Triangle Inequality.


\section{Conclusion}

